---
- name: Install vim
  apt: name=vim

- name: Prepare dirs for pathogen.vim
  file: path={{ item }} state=directory recurse=yes
  with_items:
    - '{{ vim_autoload_path }}'
    - '{{ vim_bundle_path }}'

- name: Install pathogen.vim
  get_url: url=https://tpo.pe/pathogen.vim dest={{ vim_autoload_path }}/pathogen.vim

- name: Create ~/.vimrc
  template: src=vimrc.j2 dest={{ user_home_path }}/.vimrc owner={{ user }} group={{ group_name }}

- name: Install plugins
  git: repo={{ item.git }} dest={{ vim_bundle_path }}/{{ item.name }} version=master accept_hostkey=yes
  with_items: vim_plugins

- name: Change owner
  file: {{ vim_bundle_path }}/{{ item.name }} owner={{ user }} group={{ group_name }}